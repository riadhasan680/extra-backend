import{L as U}from"./chunk-6WKBBTKM-Bz1eqlIe.js";import{I as q}from"./chunk-KIIT4BNH-DzPEFzBZ.js";import{T as L}from"./chunk-GIZFNLKK-CslZsp8I.js";import{r as i,b as y,u as G,v as J,j as e,ah as K,C as j,H as k,a3 as r,B as S,L as Q,ak as A,I as X}from"./index-D2YvuHvs.js";import{u as Y,a as Z}from"./chunk-FAB3VINY-Cz8TvMmt.js";import{A as ee}from"./alert-BU7ep9fJ.js";import"./Trans-CpX4fwIJ.js";var se=Object.defineProperty,w=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable,$=(t,a,s)=>a in t?se(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,te=(t,a)=>{for(var s in a||(a={}))I.call(a,s)&&$(t,s,a[s]);if(w)for(var s of w(a))R.call(a,s)&&$(t,s,a[s]);return t},ae=(t,a)=>{var s={};for(var l in t)I.call(t,l)&&a.indexOf(l)<0&&(s[l]=t[l]);if(t!=null&&w)for(var l of w(t))a.indexOf(l)<0&&R.call(t,l)&&(s[l]=t[l]);return s};const F=i.forwardRef((t,a)=>{var s=t,{color:l="currentColor"}=s,m=ae(s,["color"]);return i.createElement("svg",te({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:a},m),i.createElement("path",{stroke:l,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M1.5 3.278h7.111M5.056 1.5v1.778M3.278 3.278a5.43 5.43 0 0 0 3.577 4.919"}),i.createElement("path",{stroke:l,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6.833 3.278C6.478 8.278 1.5 8.61 1.5 8.61M7.722 13.5l2.667-7.111h.444l2.667 7.11M8.556 11.278h4.111"}))});F.displayName="Language";var le=Object.defineProperty,N=Object.getOwnPropertySymbols,B=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable,H=(t,a,s)=>a in t?le(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,ne=(t,a)=>{for(var s in a||(a={}))B.call(a,s)&&H(t,s,a[s]);if(N)for(var s of N(a))D.call(a,s)&&H(t,s,a[s]);return t},re=(t,a)=>{var s={};for(var l in t)B.call(t,l)&&a.indexOf(l)<0&&(s[l]=t[l]);if(t!=null&&N)for(var l of N(t))a.indexOf(l)<0&&D.call(t,l)&&(s[l]=t[l]);return s};const V=i.forwardRef((t,a)=>{var s=t,{color:l="currentColor"}=s,m=re(s,["color"]);return i.createElement("svg",ne({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:a},m),i.createElement("path",{stroke:l,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8.611 4.167h5.333M8.611 10.833h5.333M1.495 4.514l1.208 1.208 3.02-3.926M4.611 9.055H2.39a.89.89 0 0 0-.889.89v2.221c0 .492.398.89.889.89H4.61c.491 0 .889-.398.889-.89V9.945a.89.89 0 0 0-.889-.889"}))});V.displayName="ListCheckbox";var ie=({locales:t})=>{const{t:a}=y(),[s,l]=i.useState(!1),m=i.useCallback(()=>t.length<=2?t.map(u=>u.name).join(", "):`${t.slice(0,2).map(u=>u.name).join(", ")} + ${t.length-2}`,[t]),f=t.length>0;return e.jsxs(j,{className:"flex flex-col p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(k,{level:"h2",children:a("translations.activeLocales.heading")}),e.jsx(U,{variant:"interactive",className:"text-ui-fg-subtle hover:text-ui-fg-subtle-hover",to:"/settings/translations/add-locales",children:a("translations.activeLocales.noLocalesTipConfigureAction")})]}),f&&e.jsx("div",{className:"px-1 pb-1",children:e.jsx(A,{open:s,content:e.jsx("div",{className:"flex flex-col gap-y-1 p-1",children:t.map(o=>e.jsx(r,{size:"base",className:"text-ui-fg-subtle",children:o.name},o.code))}),children:e.jsxs(j,{className:"bg-ui-bg-component border-r-1 flex items-center gap-x-4 px-[19px] py-2",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:[e.jsx(q,{className:"border-ui-border-base border",children:e.jsx(F,{})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(r,{size:"small",weight:"plus",children:a("translations.activeLocales.subtitle")}),e.jsx(r,{className:"text-ui-fg-subtle",size:"small",children:m()})]})]})})})]})},oe=({entities:t,hasLocales:a=!1})=>{const{t:s}=y();return e.jsx(j,{className:"divide-y p-0",children:t.map(l=>e.jsxs("div",{className:"grid grid-cols-[250px_1fr_auto] items-center gap-x-4 px-6 py-4",children:[e.jsx(r,{size:"small",weight:"plus",children:l.label}),e.jsx(r,{size:"small",className:"text-ui-fg-subtle",children:s("translations.list.metrics",{translated:(l.translatedCount??0).toLocaleString(),total:(l.totalCount??0).toLocaleString()})}),e.jsx(Q,{to:`/settings/translations/edit?reference=${l.reference}`,children:e.jsx(S,{variant:"secondary",size:"small",disabled:!a||!l.totalCount,children:"Edit"})})]},l.reference))})},ce=({statistics:t,locales:a})=>{const{t:s}=y(),[l,m]=i.useState(null),{translatedCount:f,totalCount:o}=Object.values(t).reduce((n,c)=>({translatedCount:n.translatedCount+c.translated,totalCount:n.totalCount+c.expected}),{totalCount:0,translatedCount:0}),u=o>0?f/o*100:0,_=Math.max(0,o-f),p=i.useMemo(()=>{const n=new Map;return a.forEach(c=>{n.set(c.code,{translated:0,expected:0})}),Object.values(t).forEach(c=>{c.by_locale&&Object.entries(c.by_locale).forEach(([d,b])=>{const v=n.get(d);v&&(v.translated+=b.translated,v.expected+=b.expected)})}),a.map(c=>{const d=n.get(c.code)||{translated:0,expected:0};return{code:c.code,name:c.name,translated:d.translated,toTranslate:Math.max(0,d.expected-d.translated),total:d.expected}})},[t,a]),h=i.useMemo(()=>Math.max(...p.map(n=>n.total),1),[p]),g=i.useMemo(()=>p.length,[p]);return e.jsxs(j,{className:"p-0",children:[e.jsxs("div",{className:"flex flex-col gap-y-4 px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{level:"h2",children:s("translations.completion.heading")}),e.jsxs(r,{size:"small",weight:"plus",className:"text-ui-fg-subtle",children:[f.toLocaleString()," ",s("general.of")," ",o.toLocaleString()]})]}),e.jsx("div",{className:"flex h-3 w-full overflow-hidden",children:u>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-0.5 h-full rounded-sm transition-all",style:{width:`${u}%`,backgroundColor:"var(--tag-blue-icon)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}}),e.jsx("div",{className:"h-full flex-1 rounded-sm",style:{backgroundColor:"var(--tag-blue-border)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}})]}):e.jsx("div",{className:"h-full w-full rounded-sm",style:{backgroundColor:"var(--tag-blue-border)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(r,{size:"small",weight:"plus",className:"text-ui-fg-subtle",children:[u.toFixed(1),"%"]}),e.jsxs(r,{size:"small",weight:"plus",className:"text-ui-fg-subtle",children:[_.toLocaleString()," ",s("general.remaining").toLowerCase()]})]})]}),p.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(X,{variant:"dashed"}),e.jsxs("div",{className:"flex flex-col gap-y-3 px-6 pb-6 pt-4",children:[e.jsx("div",{className:"flex h-32 w-full items-end gap-1",children:p.map(n=>{const c=n.total/h*100,d=n.total>0?n.translated/n.total*100:0;return e.jsx(A,{open:l===n.code,content:e.jsxs("div",{className:"flex min-w-[150px] flex-col gap-y-1 p-1",children:[e.jsx(r,{size:"small",weight:"plus",children:n.name}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full",style:{backgroundColor:"var(--tag-blue-icon)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}}),e.jsx(r,{size:"small",weight:"plus",className:"text-ui-fg-base",children:s("translations.completion.translated")})]}),e.jsx(r,{size:"small",weight:"plus",className:"text-ui-fg-base",children:n.translated})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full",style:{backgroundColor:"var(--tag-blue-border)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}}),e.jsx(r,{size:"small",weight:"plus",className:"text-ui-fg-base",children:s("translations.completion.toTranslate")})]}),e.jsx(r,{size:"small",weight:"plus",className:"text-ui-fg-base",children:n.toTranslate})]})]}),children:e.jsx("div",{className:"flex h-full flex-1 items-end justify-center",children:e.jsx("div",{className:"flex w-full min-w-2 max-w-[96px] flex-col justify-end overflow-hidden rounded-t-sm transition-opacity",style:{height:`${c}%`},onMouseEnter:()=>m(n.code),onMouseLeave:()=>m(null),children:d===0?e.jsx("div",{className:"w-full rounded-sm",style:{height:"100%",backgroundColor:"var(--tag-neutral-bg)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full rounded-sm",style:{height:`${100-d}%`,backgroundColor:"var(--tag-blue-border)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)",minHeight:n.toTranslate>0?"2px":"0"}}),d>0&&e.jsx("div",{className:"mt-0.5 w-full rounded-sm",style:{height:`${d}%`,backgroundColor:"var(--tag-blue-icon)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)",minHeight:n.translated>0?"2px":"0"}})]})})})},n.code)})}),g<9&&e.jsx("div",{className:"flex w-full gap-1",children:p.map(n=>e.jsx("div",{className:"flex flex-1 items-center justify-center",children:e.jsx(r,{size:"xsmall",weight:"plus",className:"text-ui-fg-subtle min-w-2 whitespace-normal break-words text-center leading-tight",children:g<6?n.name:n.code})},n.code))}),g>9&&e.jsx(r,{weight:"plus",size:"xsmall",className:"text-ui-fg-subtle text-center",children:s("translations.completion.footer")})]})]})]})},ve=()=>{var E,M,T,O;const{t}=y(),a=G(),{store:s,isPending:l,isError:m,error:f}=J(),{translation_settings:o,isPending:u,isError:_,error:p}=Y({is_active:!0}),{statistics:h,isPending:g,isError:n,error:c}=Z({locales:((E=s==null?void 0:s.supported_locales)==null?void 0:E.map(x=>x.locale_code))??[],entity_types:Object.keys(o??{})},{enabled:!!o&&!!s&&((M=s.supported_locales)==null?void 0:M.length)>0});if(m||_||n)throw f||p||c;const d=((s==null?void 0:s.supported_locales)??[]).length>0,b=i.useMemo(()=>o?Object.entries(o).filter(([x])=>!["product_option","product_option_value"].includes(x)).map(([x,C])=>{const P=(h==null?void 0:h[x])??{translated:0,expected:0};return{label:x.split("_").map(z=>z.charAt(0).toUpperCase()+z.slice(1)).join(" "),reference:x,translatableFields:C.fields,translatedCount:P.translated,totalCount:P.expected}}).sort((x,C)=>x.label.localeCompare(C.label)):[],[o,h]),v=i.useCallback(()=>{a("/settings/translations/add-locales")},[a]),W=i.useCallback(()=>{a("/settings/translations/settings")},[a]);return!!s&&!l&&!u&&!!o&&(!!h&&!g||!d)?e.jsxs(L,{widgets:{before:[],after:[],sideBefore:[],sideAfter:[]},children:[e.jsxs(L.Main,{children:[e.jsxs(j,{className:"flex items-center justify-between px-6 py-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs(k,{children:["Manage ",t("translations.domain")]}),e.jsx(r,{className:"text-ui-fg-subtle",size:"small",children:t("translations.subtitle")})]}),e.jsxs(S,{size:"small",variant:"secondary",onClick:W,children:[e.jsx(V,{className:"text-ui-fg-subtle"}),e.jsx(r,{className:"txt-compact-small-plus text-ui-fg-base",children:t("translations.actions.manageEntities")})]})]}),!d&&e.jsx(ee,{variant:"info",className:"bg-ui-bg-base flex items-center px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-x-2",children:[e.jsxs("p",{children:[t("translations.activeLocales.noLocalesTip"),"."]}),e.jsx(S,{onClick:v,size:"small",variant:"secondary",children:t("translations.activeLocales.noLocalesTipConfigureAction")})]})}),e.jsx(oe,{entities:b,hasLocales:d})]}),e.jsxs(L.Sidebar,{children:[e.jsx(ie,{locales:((T=s==null?void 0:s.supported_locales)==null?void 0:T.map(x=>x.locale))??[]}),e.jsx(ce,{statistics:h??{},locales:((O=s==null?void 0:s.supported_locales)==null?void 0:O.map(x=>x.locale))??[]})]})]}):e.jsx(K,{sidebarSections:2})};export{ve as Component};
