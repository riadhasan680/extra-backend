import{u as ce,a as oe,b as ie}from"./chunk-NEZX6265-IvyxwQNj.js";import{u as le,a as de}from"./chunk-XNIVMZHA-QpJnJW4A.js";import{e as ue,d as pe,v as me,a as ge,j as e,el as xe,q as Z,b as v,f3 as he,w as fe,dn as je,C as H,H as W,a3 as p,A as w,P as ye,an as E,L as q,r as b,y as ve,f6 as L,h as N,am as ee,al as h,f7 as _e,f8 as Se,f9 as Ce,a2 as R,k as se,t as f,g as te,dk as be,fa as we,T as ae}from"./index-D2YvuHvs.js";import{S as Pe}from"./chunk-ADOCJB6L-DewpUc2O.js";import{u as re,_ as ne}from"./chunk-DTZXEQXZ-MEuRuO6i.js";import"./chunk-ZQJPHZKI-1TyI-cVD.js";import{S as ke}from"./chunk-GIZFNLKK-CslZsp8I.js";import"./chunk-MSDRGCRR-blRNes1y.js";import"./chunk-P3UUX2T6-C0H2Kh9I.js";import"./chunk-C76H5USB-Dz6rxCdl.js";import"./chunk-HQKGZADC-CEeFqMcu.js";import"./chunk-EMIHDNB7-BuZ3FCsW.js";import"./chunk-DFFLVEZ5-h4BEg_I0.js";import"./index-hbvpKwgw.js";import"./Trans-CpX4fwIJ.js";var Te=()=>({queryKey:Ce.details(),queryFn:async()=>Se()}),Ve=async()=>{const s=Te();return Z.getQueryData(s.queryKey)??await Z.fetchQuery(s)},Ie=({store:s})=>{var n,m,u;const{t:a}=v(),{region:t}=he(s.default_region_id,void 0,{enabled:!!s.default_region_id}),r=(n=s.supported_currencies)==null?void 0:n.find(y=>y.is_default),{sales_channel:c}=fe(s.default_sales_channel_id,{enabled:!!s.default_sales_channel_id}),{stock_location:i}=je(s.default_location_id,{fields:"id,name"},{enabled:!!s.default_location_id});return e.jsxs(H,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsxs("div",{children:[e.jsx(W,{children:a("store.domain")}),e.jsx(p,{className:"text-ui-fg-subtle",size:"small",children:a("store.manageYourStoresDetails")})]}),e.jsx(w,{groups:[{actions:[{icon:e.jsx(ye,{}),label:a("actions.edit"),to:"edit"}]}]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[e.jsx(p,{size:"small",leading:"compact",weight:"plus",children:a("fields.name")}),e.jsx(p,{size:"small",leading:"compact",children:s.name})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[e.jsx(p,{size:"small",leading:"compact",weight:"plus",children:a("store.defaultCurrency")}),r?e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(E,{size:"2xsmall",children:(m=r.currency_code)==null?void 0:m.toUpperCase()}),e.jsx(p,{size:"small",leading:"compact",children:(u=r.currency)==null?void 0:u.name})]}):e.jsx(p,{size:"small",leading:"compact",children:"-"})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[e.jsx(p,{size:"small",leading:"compact",weight:"plus",children:a("store.defaultRegion")}),e.jsx("div",{className:"flex items-center gap-x-2",children:t?e.jsx(E,{size:"2xsmall",asChild:!0,children:e.jsx(q,{to:`/settings/regions/${t.id}`,children:t.name})}):e.jsx(p,{size:"small",leading:"compact",children:"-"})})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[e.jsx(p,{size:"small",leading:"compact",weight:"plus",children:a("store.defaultSalesChannel")}),e.jsx("div",{className:"flex items-center gap-x-2",children:c?e.jsx(E,{size:"2xsmall",asChild:!0,children:e.jsx(q,{to:`/settings/sales-channels/${c.id}`,children:c.name})}):e.jsx(p,{size:"small",leading:"compact",children:"-"})})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[e.jsx(p,{size:"small",leading:"compact",weight:"plus",children:a("store.defaultLocation")}),e.jsx("div",{className:"flex items-center gap-x-2",children:i?e.jsx(E,{size:"2xsmall",asChild:!0,children:e.jsx(q,{to:`/settings/locations/${i.id}`,children:i.name})}):e.jsx(p,{size:"small",leading:"compact",children:"-"})})]})]})},M=10,ze=({store:s})=>{var C,S,F,G,K,$,J,U;const[a,t]=b.useState({}),{searchParams:r,raw:c}=ce({pageSize:M}),{currencies:i,count:n,isPending:m,isError:u,error:y}=oe({code:(C=s.supported_currencies)==null?void 0:C.map(l=>l.currency_code),...r},{placeholderData:se,enabled:!!((S=s.supported_currencies)!=null&&S.length)}),{price_preferences:g,isPending:_,isError:x,error:o}=ve({attribute:"currency_code",value:(F=s.supported_currencies)==null?void 0:F.map(l=>l.currency_code)},{enabled:!!((G=s.supported_currencies)!=null&&G.length)}),P=Re(),k=b.useMemo(()=>new Map(g==null?void 0:g.map(l=>[l.value,l])),[g]),A=i==null?void 0:i.map(l=>{var D;return{...l,is_tax_inclusive:(D=k.get(l.code))==null?void 0:D.is_tax_inclusive}}),{table:T}=re({data:A??[],columns:P,count:n,getRowId:l=>l.code,rowSelection:{state:a,updater:t},enablePagination:!0,enableRowSelection:!0,pageSize:M,meta:{storeId:s.id,supportedCurrencies:s.supported_currencies,defaultCurrencyCode:($=(K=s.supported_currencies)==null?void 0:K.find(l=>l.is_default))==null?void 0:$.currency_code,preferencesMap:k}}),{mutateAsync:I}=L(s.id),{t:d}=v(),z=N(),j=async()=>{var V;const l=Object.keys(a);await z({title:d("general.areYouSure"),description:d("store.removeCurrencyWarning",{count:l.length}),confirmText:d("actions.remove"),cancelText:d("actions.cancel")})&&await I({supported_currencies:((V=s.supported_currencies)==null?void 0:V.filter(O=>!l.includes(O.currency_code)))??[]},{onSuccess:()=>{t({}),f.success(d("store.toast.currenciesRemoved"))},onError:O=>{f.error(O.message)}})};if(u)throw y;if(x)throw o;const Y=m||_;return e.jsxs(H,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(W,{level:"h2",children:d("store.currencies")}),e.jsx(w,{groups:[{actions:[{icon:e.jsx(ee,{}),label:d("actions.add"),to:"currencies"}]}]})]}),e.jsx(ne,{orderBy:[{key:"name",label:d("fields.name")},{key:"code",label:d("fields.code")}],search:!0,pagination:!0,table:T,pageSize:M,columns:P,count:(J=s.supported_currencies)!=null&&J.length?n:0,isLoading:(U=s.supported_currencies)!=null&&U.length?Y:!1,queryObject:c}),e.jsx(h,{open:!!Object.keys(a).length,children:e.jsxs(h.Bar,{children:[e.jsx(h.Value,{children:d("general.countSelected",{count:Object.keys(a).length})}),e.jsx(h.Seperator,{}),e.jsx(h.Command,{action:j,shortcut:"r",label:d("actions.remove")})]})})]})},Ee=({storeId:s,currency:a,supportedCurrencies:t,defaultCurrencyCode:r,preferencesMap:c})=>{var g,_;const{mutateAsync:i}=L(s),{t:n}=v(),m=N(),u=async()=>{await m({title:n("general.areYouSure"),description:n("store.removeCurrencyWarning",{count:1}),verificationInstruction:n("general.typeToConfirm"),verificationText:a.name,confirmText:n("actions.remove"),cancelText:n("actions.cancel")})&&await i({supported_currencies:t.filter(o=>o.currency_code!==a.code)},{onSuccess:()=>{f.success(n("store.toast.currenciesRemoved"))},onError:o=>{f.error(o.message)}})},y=async()=>{await i({supported_currencies:t.map(x=>{const o=c.get(x.currency_code);return{...x,is_tax_inclusive:x.currency_code===a.code?!(o!=null&&o.is_tax_inclusive):void 0}})},{onSuccess:()=>{f.success(n("store.toast.updatedTaxInclusivitySuccessfully"))},onError:x=>{f.error(x.message)}})};return e.jsx(w,{groups:[{actions:[{icon:(g=c.get(a.code))!=null&&g.is_tax_inclusive?e.jsx(be,{}):e.jsx(we,{}),label:(_=c.get(a.code))!=null&&_.is_tax_inclusive?n("store.disableTaxInclusivePricing"):n("store.enableTaxInclusivePricing"),onClick:y}]},{actions:[{icon:e.jsx(ae,{}),label:n("actions.remove"),onClick:u,disabled:a.code===r}]}]})},B=te(),Re=()=>{const s=ie(),{t:a}=v();return b.useMemo(()=>[B.display({id:"select",header:({table:t})=>e.jsx(R,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:r=>t.toggleAllPageRowsSelected(!!r)}),cell:({row:t})=>e.jsx(R,{checked:t.getIsSelected(),onCheckedChange:r=>t.toggleSelected(!!r),onClick:r=>{r.stopPropagation()}})}),...s,B.accessor("is_tax_inclusive",{header:a("fields.taxInclusivePricing"),cell:({getValue:t})=>{const r=t();return e.jsx(Pe,{color:r?"green":"grey",children:a(r?"fields.true":"fields.false")})}}),B.display({id:"actions",cell:({row:t,table:r})=>{const{supportedCurrencies:c,storeId:i,defaultCurrencyCode:n,preferencesMap:m}=r.options.meta;return e.jsx(Ee,{storeId:i,currency:t.original,supportedCurrencies:c,defaultCurrencyCode:n,preferencesMap:m})}})],[s,a])},Q=10,Le=({store:s})=>{var T,I,d,z;const[a,t]=b.useState({}),{searchParams:r,raw:c}=le({pageSize:Q}),{locales:i,count:n,isPending:m,isError:u,error:y}=_e({code:(T=s.supported_locales)==null?void 0:T.map(j=>j.locale_code),...r},{placeholderData:se,enabled:!!((I=s.supported_locales)!=null&&I.length)}),g=Ae(),{table:_}=re({data:i??[],columns:g,count:n,getRowId:j=>j.code,rowSelection:{state:a,updater:t},enablePagination:!0,enableRowSelection:!0,pageSize:Q,meta:{storeId:s.id,supportedLocales:s.supported_locales}}),{mutateAsync:x}=L(s.id),{t:o}=v(),P=N(),k=async()=>{var C;const j=Object.keys(a);await P({title:o("general.areYouSure"),description:o("store.removeLocaleWarning",{count:j.length}),confirmText:o("actions.remove"),cancelText:o("actions.cancel")})&&await x({supported_locales:((C=s.supported_locales)==null?void 0:C.filter(S=>!j.includes(S.locale_code)))??[]},{onSuccess:()=>{t({}),f.success(o("store.toast.localesRemoved"))},onError:S=>{f.error(S.message)}})};if(u)throw y;const A=m;return e.jsxs(H,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(W,{level:"h2",children:o("store.locales")}),e.jsx(w,{groups:[{actions:[{icon:e.jsx(ee,{}),label:o("actions.add"),to:"locales"}]}]})]}),e.jsx(ne,{orderBy:[{key:"name",label:o("fields.name")},{key:"code",label:o("fields.code")}],search:!0,pagination:!0,table:_,pageSize:Q,columns:g,count:(d=s.supported_locales)!=null&&d.length?n:0,isLoading:(z=s.supported_locales)!=null&&z.length?A:!1,queryObject:c}),e.jsx(h,{open:!!Object.keys(a).length,children:e.jsxs(h.Bar,{children:[e.jsx(h.Value,{children:o("general.countSelected",{count:Object.keys(a).length})}),e.jsx(h.Seperator,{}),e.jsx(h.Command,{action:k,shortcut:"r",label:o("actions.remove")})]})})]})},Ne=({storeId:s,locale:a,supportedLocales:t})=>{const{mutateAsync:r}=L(s),{t:c}=v(),i=N(),n=async()=>{await i({title:c("general.areYouSure"),description:c("store.removeLocaleWarning",{count:1}),verificationInstruction:c("general.typeToConfirm"),verificationText:a.name,confirmText:c("actions.remove"),cancelText:c("actions.cancel")})&&await r({supported_locales:t.filter(u=>u.locale_code!==a.code)},{onSuccess:()=>{f.success(c("store.toast.localesRemoved"))},onError:u=>{f.error(u.message)}})};return e.jsx(w,{groups:[{actions:[{icon:e.jsx(ae,{}),label:c("actions.remove"),onClick:n}]}]})},X=te(),Ae=()=>{const s=de(),{t:a}=v();return b.useMemo(()=>[X.display({id:"select",header:({table:t})=>e.jsx(R,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:r=>t.toggleAllPageRowsSelected(!!r)}),cell:({row:t})=>e.jsx(R,{checked:t.getIsSelected(),onCheckedChange:r=>t.toggleSelected(!!r),onClick:r=>{r.stopPropagation()}})}),...s,X.display({id:"actions",cell:({row:t,table:r})=>{const{supportedLocales:c,storeId:i}=r.options.meta;return e.jsx(Ne,{storeId:i,locale:t.original,supportedLocales:c})}})],[s,a])},Ze=()=>{const s=ue(),a=pe("translation"),{store:t,isPending:r,isError:c,error:i}=me(void 0,{initialData:s}),{getWidgets:n}=ge();if(r||!t)return e.jsx(xe,{sections:2,showJSON:!0,showMetadata:!0});if(c)throw i;return e.jsxs(ke,{widgets:{before:n("store.details.before"),after:n("store.details.after")},data:t,hasOutlet:!0,showMetadata:!0,showJSON:!0,children:[e.jsx(Ie,{store:t}),e.jsx(ze,{store:t}),a&&e.jsx(Le,{store:t})]})};export{Ze as Component,Ve as loader};
