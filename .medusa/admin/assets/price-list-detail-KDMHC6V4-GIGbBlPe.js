import{L as H}from"./chunk-I3VB6NM2-DQ4El-Pb.js";import{u as Q}from"./chunk-XGSMYYUJ-Dhdru28X.js";import{g as F}from"./chunk-G2J2T2QU-DWqgg301.js";import{D as I}from"./chunk-QISH26J3-CHFxJrdE.js";import{u as M}from"./chunk-BW322BVH-D2FbCHy5.js";import{q as $,ag as J,eu as L,a as K,j as e,ah as Y,s as G,ev as W,b as u,eq as X,C as y,H as b,ai as Z,A as m,P as x,T as k,a3 as d,u as U,h as C,r as N,f as V,k as ee,ew as T,am as se,a2 as S,t as p,et as te,ba as ie,g as re}from"./index-D2YvuHvs.js";import{u as ae,_ as ce}from"./chunk-DTZXEQXZ-MEuRuO6i.js";import{u as oe,a as ne}from"./chunk-R65S6ZZV-Cv-ovqWE.js";import"./chunk-ZQJPHZKI-1TyI-cVD.js";import{T as h}from"./chunk-GIZFNLKK-CslZsp8I.js";import"./chunk-6GU6IDUA-CDc7wW5L.js";import"./chunk-DFFLVEZ5-h4BEg_I0.js";import"./chunk-XLDQPLK4-BebT61Ko.js";import"./chunk-ADOCJB6L-DewpUc2O.js";import"./chunk-P3UUX2T6-C0H2Kh9I.js";import"./chunk-IQBAUTU5-DXse4EWq.js";import"./chunk-HQKGZADC-CEeFqMcu.js";import"./chunk-EMIHDNB7-BuZ3FCsW.js";import"./chunk-C76H5USB-Dz6rxCdl.js";import"./index-hbvpKwgw.js";import"./Trans-CpX4fwIJ.js";var Oe=i=>{const{id:s}=i.params||{},{price_list:t}=L(s,void 0,{initialData:i.data,enabled:!!s});return t?e.jsx("span",{children:t.title}):null},le=i=>({queryKey:W.detail(i),queryFn:async()=>G.admin.priceList.retrieve(i)}),Be=async({params:i})=>{const s=i.id,t=le(s);return $.ensureQueryData(t)},de=({priceList:i})=>{const{t:s}=u();return e.jsxs(y,{className:"flex flex-col gap-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(b,{level:"h2",children:s("priceLists.configuration.header")}),e.jsx(ue,{priceList:i})]}),e.jsx(m,{groups:[{actions:[{label:s("actions.edit"),to:"configuration",icon:e.jsx(x,{})}]}]})]}),e.jsx(I,{endsAt:i.ends_at,startsAt:i.starts_at,showTime:!0})]})},ue=({priceList:i})=>{const{t:s}=u(),t=i.rules["customer.groups.id"],{customer_groups:r,isPending:a,isError:c,error:n}=te({id:t},{enabled:!!(t!=null&&t.length)});if(c)throw n;return t!=null&&t.length?a||!r?e.jsx(ie,{className:"h-5 w-full max-w-48"}):e.jsxs("div",{className:"txt-small-plus text-ui-fg-muted flex items-center gap-x-1.5",children:[e.jsx("span",{className:"text-ui-fg-subtle",children:s("priceLists.fields.customerAvailability.attribute")}),e.jsx("span",{children:"Â·"}),e.jsx(H,{list:r.map(o=>o.name),n:1,className:"txt-small-plus text-ui-fg-muted"})]}):null},pe=({priceList:i})=>{const{t:s}=u(),{count:t,isLoading:r,error:a}=X(i.id,{limit:1}),{color:c,text:n}=F(s,i),o=Q({priceList:i}),g=i.type==="sale"?s("priceLists.fields.type.options.sale.label"):s("priceLists.fields.type.options.override.label");return e.jsxs(y,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(b,{children:i.title}),e.jsxs("div",{className:"flex items-center gap-x-4",children:[e.jsx(Z,{color:c,children:n}),e.jsx(m,{groups:[{actions:[{label:s("actions.edit"),to:"edit",icon:e.jsx(x,{})}]},{actions:[{label:s("actions.delete"),onClick:o,icon:e.jsx(k,{})}]}]})]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(d,{leading:"compact",size:"small",weight:"plus",children:s("fields.type")}),e.jsx(d,{size:"small",className:"text-pretty",children:g})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(d,{leading:"compact",size:"small",weight:"plus",children:s("fields.description")}),e.jsx(d,{size:"small",className:"text-pretty",children:i.description})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(d,{leading:"compact",size:"small",weight:"plus",children:s("priceLists.fields.priceOverrides.label")}),!r&&!a&&e.jsx(d,{size:"small",className:"text-pretty",children:t||"-"})]})]})},f=10,j="p",me=({priceList:i})=>{const{t:s}=u(),t=U(),r=C(),[a,c]=N.useState({}),{searchParams:n,raw:o}=oe({pageSize:f,prefix:j}),{products:g,count:v,isLoading:D,isError:_,error:A}=V({...n,price_list_id:[i.id]},{placeholderData:ee}),E=ne(),P=ge(i),{mutateAsync:R}=T(i.id),{table:z}=ae({data:g||[],count:v,columns:P,enablePagination:!0,enableRowSelection:!0,pageSize:f,getRowId:l=>l.id,rowSelection:{state:a,updater:c},prefix:j}),q=async()=>{await r({title:s("general.areYouSure"),description:s("priceLists.products.delete.confirmation",{count:Object.keys(a).length}),confirmText:s("actions.delete"),cancelText:s("actions.cancel")})&&R({remove:Object.keys(a)},{onSuccess:()=>{p.success(s("priceLists.products.delete.successToast",{count:Object.keys(a).length})),c({})},onError:B=>{p.error(B.message)}})},O=async()=>{const l=Object.keys(a).join(",");t(`products/edit?ids[]=${l}`)};if(_)throw A;return e.jsxs(y,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(b,{level:"h2",children:s("priceLists.products.header")}),e.jsx(m,{groups:[{actions:[{label:s("priceLists.products.actions.addProducts"),to:"products/add",icon:e.jsx(se,{})},{label:s("priceLists.products.actions.editPrices"),to:"products/edit",icon:e.jsx(x,{})}]}]})]}),e.jsx(ce,{table:z,filters:E,columns:P,count:v,pageSize:f,isLoading:D,navigateTo:l=>`/products/${l.original.id}`,orderBy:[{key:"title",label:s("fields.title")},{key:"created_at",label:s("fields.createdAt")},{key:"updated_at",label:s("fields.updatedAt")}],commands:[{action:O,label:s("actions.edit"),shortcut:"e"},{action:q,label:s("actions.delete"),shortcut:"d"}],pagination:!0,search:!0,prefix:j,queryObject:o})]})},xe=({product:i,priceList:s})=>{const{t}=u(),r=C(),{mutateAsync:a}=T(s.id),c=async()=>{await r({title:t("general.areYouSure"),description:t("priceLists.products.delete.confirmation",{count:1}),confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&a({remove:[i.id]},{onSuccess:()=>{p.success(t("priceLists.products.delete.successToast",{count:1}))},onError:o=>{p.error(o.message)}})};return e.jsx(m,{groups:[{actions:[{icon:e.jsx(x,{}),label:t("priceLists.products.actions.editPrices"),to:`products/edit?ids[]=${i.id}`}]},{actions:[{icon:e.jsx(k,{}),label:t("actions.remove"),onClick:c}]}]})},w=re(),ge=i=>{const s=M();return N.useMemo(()=>[w.display({id:"select",header:({table:t})=>e.jsx(S,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:r=>t.toggleAllPageRowsSelected(!!r)}),cell:({row:t})=>e.jsx(S,{checked:t.getIsSelected(),onCheckedChange:r=>t.toggleSelected(!!r),onClick:r=>{r.stopPropagation()}})}),...s,w.display({id:"actions",cell:({row:t})=>e.jsx(xe,{product:t.original,priceList:i})})],[s,i])},He=()=>{const{id:i}=J(),{price_list:s,isLoading:t,isError:r,error:a}=L(i),{getWidgets:c}=K();if(t||!s)return e.jsx(Y,{mainSections:2,sidebarSections:1,showJSON:!0});if(r)throw a;return e.jsxs(h,{widgets:{after:c("price_list.details.after"),before:c("price_list.details.before"),sideAfter:c("price_list.details.side.after"),sideBefore:c("price_list.details.side.before")},data:s,showJSON:!0,children:[e.jsxs(h.Main,{children:[e.jsx(pe,{priceList:s}),e.jsx(me,{priceList:s})]}),e.jsx(h.Sidebar,{children:e.jsx(de,{priceList:s})})]})};export{Oe as Breadcrumb,He as Component,Be as loader};
